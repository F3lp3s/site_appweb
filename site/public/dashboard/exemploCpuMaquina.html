
<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/cpuMaquina.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="../js/funcoes.js"></script>
  <script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>
  <title>Document</title>
  <script type='text/javascript' src='https://widget.freshworks.com/widgets/72000002928.js' async defer></script>
</head>


  <div class="container">

    <div class="sidebar">
      <div class="cont-img">
        <img src="../imagens/Logo.png">
      </div>

      <div class="cont-text">
        <div class="inicio-nav">
          <div class="icon-home">
            <img src="../imagens/homeBranco.png" alt="">
          </div>
          <div class="text-home">
            <p>Pagina<br>
              Inicial</p>
          </div>
        </div>

        <div class="status-nav">
          <div class="icon-status">
            <img src="../imagens/statusBranco.png" alt="">
          </div>
          <div class="text-status">
            <p>Status</p>
          </div>
        </div>

        <div class="historico-nav">
          <div class="icon-historico">
            <img src="../imagens/historicoBranco.png" alt="">
          </div>
          <div class="text-historico">
            <p>Histórico</p>
          </div>
        </div>

        <div class="gestao-nav">
          <div class="icon-gestao">
            <img src="../imagens/gestaoBranco.png" alt="">
          </div>
          <div class="text-gestao">
            <p>Gestão de<br>
              Funcionario</p>
          </div>
        </div>

        <div class="sair-nav">
          <div class="icon-sair">
            <img src="../imagens/sair.png" alt="">
          </div>
          <div class="text-sair">
            <p>Sair</p>
          </div>
        </div>
      </div>
    </div>
    <div class="titulo">
      <div class="textoTitulo">Servidor X - Memória </div>
      <div class="selectTituloFeed">
        <select class="SelectMemorias">
          <option class="OptinoMemorias" value="">Memoria X</option>

        </select>
      </div>
    </div>
    <div class="grafico">
      <div class="chartJs">
        
        <canvas  id="canvas_dislike"></canvas>
        

      </div>
    </div>
    <div class="legendaGrafico">
      <div class="memorias">
        <div class="textoMemorias"> Memoria  Disponivel </div> 
        <div class="dadoMemorias" > 64GB </div>
      </div>
      <div style="margin-left: 7vw;" class="memorias">
        <div style="width: 9vw;" class="textoMemorias"> Memoria Total </div> 
        <div class="dadoMemorias" > 128GB </div>
      </div>


    </div>

    <div class="listaMaquinas">
      <div class="tituloMaquinas"> Maquinas: </div>
      <div class="Maquinas"> <br> <br>
        Servidor xxx <br> <br>
        Servidor yyy <br> <br>
        servidor aaa <br> <br>
        caixa 1 <br> <br>
        caixa 2 <br> <br>
        caixa 3 <br>

        

      </div>
    </div>
  </div>
</body>

</html>
<script>
 


 
 let proximaAtualizacao;


window.onload = obterDadosMemoria();



//verificar_autenticacao();

// altere aqui como os dados serão exibidos
// e como são recuperados do BackEnd


function obterDadosMemoria(memoria_uso) {
    if (proximaAtualizacao != undefined) {
        clearTimeout(proximaAtualizacao);
    }

    fetch('/medidas/Memoria', { cache: 'no-store' }).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                resposta.reverse();

                plotarMemoria(resposta);
            });
        } else {
            console.error('Nenhum dado encontrado ou erro na API');
        }
    })
        .catch(function (error) {
            console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
        });

}

// só altere aqui se souber o que está fazendo!
function plotarMemoria(resposta) {
    console.log('iniciando plotagem do gráfico...');
  
    var dados = {
        labels: [],
        datasets: [
            {
                yAxisID: '',
                label: 'Mémoria em uso',
                borderColor: '',
                backgroundColor: 'white',
                Color: 'white',
                fill: true,
                data: []
            }
        ]
        };

    for (i = 0; i < resposta.length; i++) {
        var registro = resposta[i];
        dados.labels.push(registro.data_medicao);
        dados.datasets[0].data.push(registro.memoria_uso);
    }

    console.log(JSON.stringify(dados));

    var ctx = canvas_dislike.getContext("2d");
        window.grafico_linha = Chart.Bar(ctx, {
            data: dados,
            //Configurações do gráfico
            options: {
                
              responsive: true,
              animation: { duration: 500 },
              hoverMode: 'index',
              sstacked: false,
         
                title: {
                    display: true,
                    text: 'Memoria em uso'
                },
                
               
            }
        });
    
}
window.fwSettings={
	'widget_id':72000002928
	};
	!function(){if("function"!=typeof window.FreshworksWidget){var n=function(){n.q.push(arguments)};n.q=[],window.FreshworksWidget=n}}() 
   
</script>
